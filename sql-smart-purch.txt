select
CONVERT(char(10), f.Fecha, 103) as [date_sales],
p.ID as producto_id,
sum(dt.Cantidad) as Cantidad,
sum(dt.Total) as total
from 
VEN_FACTURAS f inner join VEN_FACTURAS_DT  dt on f.ID = dt.FacturaID inner join 
INV_PRODUCTOS p on dt.ProductoID = p.ID
where f.Anulado = 0
group by f.Fecha, p.id

select 
CONVERT(char(10), c.Fecha, 103) as [date_compra],
p.ID as producto_id,
ac.Nombre as proveedor,
dt.Cantidad,
dt.Total
from 
COM_FACTURAS c inner join COM_FACTURAS_DT dt on c.ID = dt.FacturaID inner join 
INV_PRODUCTOS p on p.ID = dt.ProductoID inner join ACR_ACREEDORES ac on c.ProveedorID = ac.ID
where c.Anulado = 0 and YEAR(c.Fecha) > 2023
group by c.Fecha,c.id,p.id,ac.Nombre,dt.Cantidad,dt.Total
order by producto_id

select 
p.ID as producto_id,
p.C贸digo as code,
p.Nombre as name,
ISNULL( SUM( CASE cd.Egreso WHEN 1 THEN ROUND(-Cantidad,2) ELSE ROUND(Cantidad,2) END ), 0 ) as stock,
p.Conversi贸n
from
INV_PRODUCTOS p inner join INV_PRODUCTOS_CARDEX cd on p.ID = cd.ProductoID
where p.Anulado = 0 and cd.Anulado = 0 and cd.BodegaID = '0000000001' 
group by p.C贸digo,p.Nombre,p.Conversi贸n,p.ID


select 
Id,
CreadoDate AS [Date],
Detalle,
case 
when SucursalID = 00 then 'MATRIZ'
when SucursalID = 01 then 'DESEO'
when SucursalID = 02 then 'MARISCAL'
end AS SUCURSAL,
Total from VEN_FACTURAS where Anulado = 0 and year(Fecha) = 2025
